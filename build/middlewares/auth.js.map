{"version":3,"sources":["../../src/middlewares/auth.js"],"names":["auth","req","res","next","authorization","headers","token","status","json","data","error","message","decode","jwt","verify","process","env","jwt_secret","userSchema","findById","id","password","userData","errors","user","console","log"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEA,IAAMA,IAAI;AAAA,2FAAG,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEHC,YAAAA,aAFG,GAEaH,GAAG,CAACI,OAAJ,CAAYC,KAFzB;;AAAA,gBAGJF,aAHI;AAAA;AAAA;AAAA;;AAAA,6CAIAF,GAAG,CACPK,MADI,CACG,GADH,EAEJC,IAFI,CAEC;AAAEC,cAAAA,IAAI,EAAE,EAAR;AAAYC,cAAAA,KAAK,EAAE,EAAnB;AAAuBC,cAAAA,OAAO,EAAE;AAAhC,aAFD,CAJA;;AAAA;AAST;AACMC,YAAAA,MAVG,GAUMC,yBAAIC,MAAJ,CAAWV,aAAX,EAA0BW,OAAO,CAACC,GAAR,CAAYC,UAAtC,CAVN;AAAA;AAAA,mBAWcC,uBAAWC,QAAX,CAAoBP,MAAM,CAACQ,EAA3B,EAA+B;AACpDC,cAAAA,QAAQ,EAAE;AAD0C,aAA/B,CAXd;;AAAA;AAWHC,YAAAA,QAXG;;AAAA,gBAcJA,QAdI;AAAA;AAAA;AAAA;;AAAA,6CAeApB,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,cAAAA,IAAI,EAAE,EADoB;AAE1Bc,cAAAA,MAAM,EAAE,EAFkB;AAG1BZ,cAAAA,OAAO,EAAE;AAHiB,aAArB,CAfA;;AAAA;AAqBTV,YAAAA,GAAG,CAACuB,IAAJ,GAAWF,QAAX;AACAnB,YAAAA,IAAI;AAtBK;AAAA;;AAAA;AAAA;AAAA;AAwBTsB,YAAAA,OAAO,CAACC,GAAR,CAAY,YAAMf,OAAlB;;AAxBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAJX,IAAI;AAAA;AAAA;AAAA,GAAV;;eA4BeA,I","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport userSchema from \"../models/schemas/userSchema\";\r\n\r\nconst auth = async (req, res, next) => {\r\n  try {\r\n    const authorization = req.headers.token;\r\n    if (!authorization) {\r\n      return res\r\n        .status(401)\r\n        .json({ data: {}, error: [], message: \"Please login!!\" });\r\n    }\r\n\r\n    // const token = authorization.split(\" \")[1];\r\n    const decode = jwt.verify(authorization, process.env.jwt_secret);\r\n    const userData = await userSchema.findById(decode.id, {\r\n      password: 0,\r\n    });\r\n    if (!userData) {\r\n      return res.status(400).json({\r\n        data: {},\r\n        errors: [],\r\n        message: \"Not a valid user!\",\r\n      });\r\n    }\r\n    req.user = userData;\r\n    next();\r\n  } catch (error) {\r\n    console.log(error.message);\r\n  }\r\n};\r\n\r\nexport default auth;\r\n"],"file":"auth.js"}